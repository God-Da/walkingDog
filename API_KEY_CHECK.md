# 🔍 API 키 문제 해결 체크리스트

## 현재 상황
- API 키: `17c565db1c8d5ce49ddd51d20f04593f0333667d36b75e64d1f9f2e421327312`
- 오류: 403 Forbidden

## 확인 사항

### 1. 공공데이터포탈에서 확인
1. [공공데이터포탈](https://www.data.go.kr/) 로그인
2. **마이페이지** > **개발계정** 이동
3. **일반 인증키(Encoding)** 확인
   - 위의 키와 동일한지 확인
   - 키가 만료되지 않았는지 확인

### 2. API 신청 상태 확인
1. **마이페이지** > **API 신청현황** 또는 **활용신청**
2. 다음 API들이 **승인 완료** 상태인지 확인:
   - ✅ 에어코리아 대기오염정보 조회 서비스
   - ✅ 기상청 단기예보 조회 서비스
3. **대기 중** 또는 **반려** 상태면 사용 불가

### 3. API 테스트
백엔드 실행 후 다음 URL로 테스트:

```
http://localhost:8080/api/test/air-quality
```

이 엔드포인트는:
- 인코딩된 키로 시도
- 인코딩하지 않은 키로 시도
- 정확한 오류 메시지 반환

### 4. 직접 API 테스트
브라우저에서 직접 테스트:

```
http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty?serviceKey=17c565db1c8d5ce49ddd51d20f04593f0333667d36b75e64d1f9f2e421327312&returnType=json&numOfRows=1&pageNo=1&stationName=강남구&dataTerm=DAILY&ver=1.0
```

**응답 확인:**
- 정상: JSON 데이터
- 오류: 오류 메시지 (예: `SERVICE_KEY_IS_NOT_REGISTERED`)

### 5. 가능한 원인

#### A. API 신청 미완료
- API를 신청했지만 승인 대기 중
- **해결**: 공공데이터포탈에서 승인 상태 확인

#### B. API 키 형식 오류
- Encoding 키가 아닌 Decoding 키 사용
- **해결**: 마이페이지에서 **일반 인증키(Encoding)** 확인

#### C. 일일 호출 제한 초과
- 무료 계정은 보통 1,000회/일 제한
- **해결**: 다음날 다시 시도

#### D. 측정소 이름 오류
- "강남구"가 정확한 측정소 이름이 아닐 수 있음
- **해결**: 측정소 목록 API로 정확한 이름 확인

### 6. 임시 해결책
현재 코드는 API 호출 실패 시 기본값을 반환하도록 구현되어 있습니다:
- PM10: 0
- PM2.5: 0
- 기온: 20°C
- 하늘 상태: 맑음

이 상태로도 서비스는 동작하지만, 실제 데이터는 표시되지 않습니다.

## 다음 단계
1. `/api/test/air-quality` 엔드포인트로 테스트
2. 공공데이터포탈에서 API 신청 상태 확인
3. 로그의 상세 오류 메시지 확인
4. 필요시 공공데이터포탈 고객센터 문의


